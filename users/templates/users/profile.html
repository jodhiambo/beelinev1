{% extends 'mainapp/base.html' %}
{% load crispy_forms_tags %}
{% load static %}

{% block css %}
{% include 'mainapp/head4.html' %}
{% endblock css %}


{% block content %}
      <nav id="navbar-main" class="navbar navbar-horizontal navbar-transparent navbar-main navbar-expand-lg navbar-light">
        <div class="container">
          <a class="navbar-brand" href="{% url 'mainapp:homepage' %}">
            <img src="{% static 'assets/img/logo.png' %}" style="width:200px; height:auto">
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="navbar-collapse navbar-custom-collapse collapse" id="navbar-collapse">
            <div class="navbar-collapse-header">
              <div class="row">
                <div class="col-6 collapse-brand">
                  <a href="{% url 'mainapp:homepage' %}">
                    <img src="{% static 'assets/img/logo.png' %}" style="width:200px; height:auto">
                  </a>
                </div>
                <div class="col-6 collapse-close">
                  <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span></span>
                    <span></span>
                  </button>
                </div>
              </div>
            </div>
            <ul class="navbar-nav mr-auto">
              <li class="nav-item">
                <a href="{% url 'mainapp:homepage' %}" class="nav-link">
                  <span class="nav-link-inner--text">Home</span>
                </a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" aria-expanded="false" data-toggle="dropdown">
                    <span class="nav-link-inner-text mr-0">Challenges</span>

                </a>
                <div class="dropdown-menu dropdown-menu-lg">
                    <div class="col-auto px-0" data-dropdown-content>
                        <div class="list-group list-group-flush">
                            <a href="{% url 'mainapp:challenges' %}"
                                class="list-group-item list-group-item-action d-flex align-items-center p-0 py-3 px-lg-4">
                                <span class="icon icon-sm icon-success"><i class="fas fa-check-double" style="color:#24262b!important;"></i></span>
                                <div class="ml-4">
                                    <span class="text-dark d-block">All Challenges</span>
                                </div>
                            </a>
                            <a href="{% url 'mainapp:open-challenges' %}"
                                class="list-group-item list-group-item-action d-flex align-items-center p-0 py-3 px-lg-4">
                                <span class="icon icon-sm icon-success"><i
                                        class="fas fa-box-open" style="color:#05A677!important;"></i></span>
                                <div class="ml-4">
                                    <span class="text-dark d-block">Open Challenges</span>
                                </div>
                            </a>
                            <a href="{% url 'mainapp:rolling' %}"
                                class="list-group-item list-group-item-action d-flex align-items-center p-0 py-3 px-lg-4">
                                <span class="icon icon-sm icon-primary"><i
                                        class="fas fa-sync-alt" style="color:#0648B3!important;"></i></span>
                                <div class="ml-4">
                                    <span class="text-dark d-block">Open With No Deadline</span>
                                </div>
                            </a>
                            <a href="{% url 'mainapp:coming-soon' %}"
                                class="list-group-item list-group-item-action d-flex align-items-center p-0 py-3 px-lg-4">
                                <span class="icon icon-sm icon-purple"><i
                                        class="far fa-clock" style="color:#8965e0!important;"></i></span>
                                <div class="ml-4">
                                    <span class="text-dark d-block">Coming Soon</span>
                                </div>
                            </a>
                            <a href="{% url 'mainapp:archived' %}"
                                class="list-group-item list-group-item-action d-flex align-items-center p-0 py-3 px-lg-4">
                                <span class="icon icon-sm icon-danger"><i
                                        class="fas fa-archive" style="color:#FA5252!important;"></i></span>
                                <div class="ml-4">
                                    <span class="text-dark d-block">Archived Challenges</span>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
              </li>
              <li class="nav-item">
                  <a href="{% url 'mainapp:about'%}" class="nav-link" >About Us</a>
              </li>
              <li class="nav-item">
                  <a href="{% url 'news:news'%}" class="nav-link" >News</a>
              </li>
              <li class="nav-item">
              <a href="{% url 'mainapp:submit-a-challenge'%}" target="_blank" class="nav-link"><i class="fas fa-paper-plane mr-2"></i>Submit a Challenge</a>
              </li>
              
              {% if not user.is_authenticated %}
              <li class="nav-item">
                  <a href="{% url 'users:account_login' %}" class="nav-link" >Login or Register</a>
              </li>
              {% else %}
              <li class="nav-item">
                  <a href="{% url 'userprofiles:profile' %}" class="nav-link">Profile</a>
              </li>
              <li class="nav-item">
              <a href="{% url 'account_logout' %}" class="nav-link" >Logout</a>
              </li>
              {% endif %}  
            </ul>
          </div>
        </div>
      </nav>

  <!-- Main content -->
  <div class="main-content" id="panel">
    <!-- Header -->
    <div class="header pb-6 d-flex align-items-center" style="min-height: 500px; background-image: url(../../static/assets/img/img-1-1000x600.jpg); background-size: cover; background-position: center top;">
      <!-- Mask -->
      <span class="mask bg-gradient-default opacity-8"></span>
      <!-- Header container -->
      <div class="container-fluid d-flex align-items-center">
        <div class="row">
          <div class="col-lg-7 col-md-10">
          {% if user.profile.first_name and user.profile.last_name %}
            <h1 class="display-2 text-white">Hello {{user.profile.first_name}}</h1>
          {% else %}
          <h1 class="display-2 text-white">Hello {{user.username}}</h1>
          {% endif %}
            <p class="text-white mt-0 mb-5">This is your profile page. You can view your information and edit it as you wish</p>
            <!--<a href="#!" class="btn btn-neutral">Edit profile</a>-->
          </div>
        </div>
      </div>
    </div>
    <!-- Page content -->
    <div class="container-fluid mt--6">
      <div class="row">
        <div class="col-xl-4 order-xl-2">
          <div class="card card-profile">
            <img src="{% static 'assets/img/img-1-1000x600.jpg' %}" alt="Image placeholder" class="card-img-top">
            <div class="row justify-content-center">
              <div class="col-lg-3 order-lg-2">
                <div class="card-profile-image">
                  
                    <div class="rounded-circle" style="max-width: 140px;width:100px;height:100px;border-radius: 0.375rem;border: 3px solid #fff;transform: translate(-50%, -50%) scale(1);position: absolute;left: 50%;transition: all 0.15s ease;background-color:#ed8f03">
                    <span class="text-white" style="display: flex;  justify-content: center; font-size:60px;  align-items: center;">{{avatar_holder}}</span>
                    </div>
                  
                </div>
              </div>
            </div>
            <div class="card-header text-center border-0 pt-8 pt-md-4 pb-0 pb-md-4">
              <br>
            </div>
            <div class="card-body pt-0">
              <div class="text-center">
                <h5 class="h3">
                  {% if user.profile.first_name and user.profile.last_name %}
                  <p class="font-weight-bold">{{user.profile.first_name}} {{user.profile.last_name}}</p>
                  {% else %}
                  <p class="font-weight-bold">{{user.username}}</p>
                  {% endif %}
                </h5>
                <div class="h5 font-weight-bold">
                  <i class="fa fa-envelope mr-2"></i>{% if user.email %}{{user.email}}{% else %}No Email set{% endif %}
                </div>
                <div class="h5 mt-4 font-weight-bold">
                  <i class="fa fa-flag mr-2"></i>{% if user.profile.country_of_residence %}{{user.profile.country_of_residence}}{% else %}No Country set{% endif %}
                </div>
                <div class="h5 font-weight-bold">
                  <i class="fa fa-briefcase mr-2"></i>{% if user.profile.organization %}{{user.profile.organization}}{% else %}No Organization set{% endif %}
                </div>
              </div>
            </div>
          </div>
          <!-- Progress track -->
          <div class="card">
            <!-- Card header -->
            <div class="card-header">
              <!-- Title -->
              <h5 class="h3 mb-0">Bookmarked Challenges <a href="{% url 'mainapp:favourite-challenges' %}" class="btn btn-sm btn-primary" style="float:right">SEE ALL</a></h5>
            </div>
            <!-- Card body -->
            <div class="card-body">
              <!-- List group -->
              <ul class="list-group list-group-flush list my--3">
              {% if favourite_posts %}
              {% for fav in favourite_posts %}
                <li class="list-group-item px-0">
                  <div class="row align-items-center">
                    <div class="col-auto">
                      <!-- Avatar -->
                      <a class="avatar rounded-circle" style="border: 1px solid #ddd; background-color:white!important;">
                        <i class="fas fa-bookmark" style="color:rgba(0,0,0,.68);"></i>
                      </a>
                    </div>
                    <div class="col">
                      <h3><a href="{% url 'mainapp:detail' fav.id fav.slug%}">{{fav.title}}</a></h3>
                      <div class="">
                        <p class="small text-muted">
                        <a href="{% url 'mainapp:detail' fav.id fav.slug%}" style="color:black!important;">
                        {{fav.challenge_summary|truncatechars:"100"|safe}}
                        </a>
                        </p>
                      </div>
                    </div>
                  </div>
                </li>
              {% endfor %}
              {% else %}
              <br>
              <p class="text-center text-gray display-5">No Bookmarks yet</p>
              {% endif %}
              </ul>
            </div>
          </div>
        </div>

        <div class="col-xl-8 order-xl-1">
          <div class="row">
          </div>
          <div class="card">
            <div class="card-header">
            {% for message in messages %}
  <div class="alert {{ message.tags }} alert-dismissible fade show" role="alert">
  <span class="alert-inner--icon"><i class="far fa-thumbs-up"></i></span>
  <span class="alert-inner--text">{{ message }}</span>
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
{% endfor %}
              <div class="row align-items-center">
                <div class="col-8">
                  <h3 class="mb-0">Edit profile </h3>
                </div>
                <div class="col-4 text-right">
                  <!--<a href="#!" class="btn btn-sm btn-primary">Settings</a>-->
                </div>
              </div>
            </div>
            <div class="card-body">
              <form method="POST">
              {% csrf_token %}
                <h6 class="heading-small text-muted mb-4">User information</h6>
                <div class="pl-lg-4">
                  <div class="row">
                    <div class="col-lg-12">
                      <div class="form-group">
                        <!--<label class="form-control-label" for="input-username">Username</label>-->
                        {{p_form.first_name|as_crispy_field}}
                       <!--<input type="text" id="input-username" class="form-control" placeholder="Username" value="lucky.jesse">-->
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="row">
                  <div class="col-lg-12">
                      <div class="form-group">
                        {{p_form.last_name|as_crispy_field}}
                      </div>
                    </div>
                  </div>
                  <br>
                </div>
                <br>
                <!-- Address -->
                <h6 class="heading-small text-muted mb-4">Contact information</h6>
                <div class="pl-lg-4">
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        {{p_form.organization|as_crispy_field}}
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        {{p_form.sex|as_crispy_field}}
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="row">
                    <div class="col-lg-6">
                      <div class="form-group">
                        {{p_form.nationality|as_crispy_field}}
                      </div>
                    </div>
                    <div class="col-lg-6">
                      <div class="form-group">
                        {{p_form.country_of_residence|as_crispy_field}}
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="row">
                    <div class="col-lg-12">
                      <div class="form-group">
                        {{p_form.age_group|as_crispy_field}}
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-lg-12">
                      <div class="form-group">
                        {{p_form.consent_to_share_my_information|as_crispy_field}}
                      </div>
                      <div class="form-group">
                        {{p_form.consent_to_view_my_bookmarks|as_crispy_field}}
                      </div>
                    </div>
                  </div>
                </div>
                <br>
              <center><button class="btn mb-2 mr-2 btn-info animate-up-2" type="submit">Submit</button></center>
              </form>
            </div>
          </div>
        </div>
      </div>

{% endblock content %}

{% block footer %}
{% include 'mainapp/footer2.html' %}
{% endblock footer %}
    </div>
  </div>

{% block js %}
{% include 'mainapp/head3-bottom.html' %}
{% endblock js %}
